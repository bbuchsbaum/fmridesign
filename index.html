<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Design Matrix Construction for fMRI Analysis • fmridesign</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Design Matrix Construction for fMRI Analysis">
<meta name="description" content="Constructs and inspects design matrices for functional magnetic resonance imaging (fMRI) analyses. Provides a formula interface for specifying event-related designs with flexible hemodynamic response function (HRF) bases, parametric modulators, and trialwise models. Includes facilities for baseline/nuisance regressors, contrast specification, and utilities for naming, validation, and visualization. Intended to support the model-building stage prior to statistical fitting. Implements methods described in Friston et al. (1995) &lt;doi:10.1006/nimg.1995.1007&gt; and Lindquist (2008) &lt;doi:10.1214/09-STS282&gt;.">
<meta property="og:description" content="Constructs and inspects design matrices for functional magnetic resonance imaging (fMRI) analyses. Provides a formula interface for specifying event-related designs with flexible hemodynamic response function (HRF) bases, parametric modulators, and trialwise models. Includes facilities for baseline/nuisance regressors, contrast specification, and utilities for naming, validation, and visualization. Intended to support the model-building stage prior to statistical fitting. Implements methods described in Friston et al. (1995) &lt;doi:10.1006/nimg.1995.1007&gt; and Lindquist (2008) &lt;doi:10.1214/09-STS282&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">fmridesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="articles/a_01_introduction.html">Introduction to fmridesign</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Core Concepts</h6></li>
    <li><a class="dropdown-item" href="articles/a_04_event_models.html">Building Event Models</a></li>
    <li><a class="dropdown-item" href="articles/a_03_baseline_model.html">Baseline and Nuisance Effects</a></li>
    <li><a class="dropdown-item" href="articles/a_05_contrasts.html">Contrasts</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bbuchsbaum/fmridesign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="fmridesign">fmridesign<a class="anchor" aria-label="anchor" href="#fmridesign"></a>
</h1></div>
<p>Design Matrix Construction for fMRI Analysis</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>fmridesign</code> provides tools for constructing design matrices for functional magnetic resonance imaging (fMRI) analyses. It includes facilities for creating event models with flexible hemodynamic response functions (HRFs), baseline models for nuisance regression, and utilities for handling experimental designs.</p>
<p>This package focuses on the design aspect of fMRI analysis and is intended to be used with analysis packages like <code>fmrireg</code>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install development version from GitHub</span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"bbuchsbaum/fmridesign"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h2>
<ul>
<li>
<strong>Event Models</strong>: Create experimental design matrices with flexible HRF specifications</li>
<li>
<strong>Baseline Models</strong>: Build nuisance regressors for drift, motion, and other confounds<br>
</li>
<li>
<strong>Flexible HRFs</strong>: Support for various hemodynamic response functions via the <code>fmrihrf</code> package</li>
<li>
<strong>Block Designs</strong>: Handle multi-run/session fMRI experiments</li>
</ul>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbuchsbaum/fmridesign" class="external-link">fmridesign</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create event data</span></span>
<span><span class="va">event_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  onsets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">80</span><span class="op">)</span>,</span>
<span>  run <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define sampling frame</span></span>
<span><span class="va">sframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bbuchsbaum.github.io/fmrihrf/reference/sampling_frame.html" class="external-link">sampling_frame</a></span><span class="op">(</span>blocklens <span class="op">=</span> <span class="fl">100</span>, TR <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create event model</span></span>
<span><span class="va">ev_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/event_model.html">event_model</a></span><span class="op">(</span></span>
<span>  <span class="va">onsets</span> <span class="op">~</span> <span class="fu"><a href="reference/hrf.html">hrf</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">event_data</span>,</span>
<span>  block <span class="op">=</span> <span class="op">~</span><span class="va">run</span>,</span>
<span>  sampling_frame <span class="op">=</span> <span class="va">sframe</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create baseline model</span></span>
<span><span class="va">base_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/baseline_model.html">baseline_model</a></span><span class="op">(</span></span>
<span>  basis <span class="op">=</span> <span class="st">"bs"</span>,</span>
<span>  degree <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  sframe <span class="op">=</span> <span class="va">sframe</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract design matrices</span></span>
<span><span class="va">event_dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/design_matrix.html">design_matrix</a></span><span class="op">(</span><span class="va">ev_model</span><span class="op">)</span></span>
<span><span class="va">baseline_dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/design_matrix.html">design_matrix</a></span><span class="op">(</span><span class="va">base_model</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="related-packages">Related Packages<a class="anchor" aria-label="anchor" href="#related-packages"></a>
</h2>
<ul>
<li>
<code>fmrireg</code>: Analysis and fitting of fMRI models</li>
<li>
<code>fmrihrf</code>: Hemodynamic response functions</li>
<li>
<code>fmridataset</code>: fMRI dataset structures</li>
</ul>
</div>
<div class="section level2">
<h2 id="documentation--vignettes">Documentation &amp; Vignettes<a class="anchor" aria-label="anchor" href="#documentation--vignettes"></a>
</h2>
<ul>
<li>Online site (pkgdown): <a href="https://bbuchsbaum.github.io/fmridesign/" class="uri">https://bbuchsbaum.github.io/fmridesign/</a>
</li>
<li>Articles index: <a href="https://bbuchsbaum.github.io/fmridesign/articles/" class="uri">https://bbuchsbaum.github.io/fmridesign/articles/</a>
</li>
</ul>
<p>From R, you can also open installed vignettes:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"a_01_introduction"</span>, package <span class="op">=</span> <span class="st">"fmridesign"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"a_03_baseline_model"</span>, package <span class="op">=</span> <span class="st">"fmridesign"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"a_04_event_models"</span>, package <span class="op">=</span> <span class="st">"fmridesign"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"a_05_contrasts"</span>, package <span class="op">=</span> <span class="st">"fmridesign"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>GPL (&gt;= 2)</p>
</div>
<div class="section level2">
<h2 id="albers-theme">Albers theme<a class="anchor" aria-label="anchor" href="#albers-theme"></a>
</h2>
<p>This package uses the albersdown theme. Vignettes are styled with <code>vignettes/albers.css</code> and a local <code>vignettes/albers.js</code>; the palette family is provided via <code>params$family</code> (default ‘red’). The pkgdown site uses <code>template: { package: albersdown }</code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/bbuchsbaum/fmridesign/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/bbuchsbaum/fmridesign/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fmridesign</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Bradley Buchsbaum <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
