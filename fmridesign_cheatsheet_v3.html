<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>fmridesign • fmridesign</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="fmridesign"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">fmridesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/a_01_introduction.html">Introduction to fmridesign</a></li>
    <li><a class="dropdown-item" href="articles/a_03_baseline_model.html">Modeling Baseline and Nuisance Effects</a></li>
    <li><a class="dropdown-item" href="articles/a_04_event_models.html">Building Event Models</a></li>
    <li><a class="dropdown-item" href="articles/a_05_contrasts.html">Contrasts in fmridesign</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bbuchsbaum/fmridesign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>fmridesign</h1>
      <small class="dont-index">Source: <a href="https://github.com/bbuchsbaum/fmridesign/blob/main/fmridesign_cheatsheet_v3.md" class="external-link"><code>fmridesign_cheatsheet_v3.md</code></a></small>
    </div>


<div class="section level2">
<h2 id="micro-dsl-v34-source-format-grammar">Micro-DSL v3.4 Source Format Grammar<a class="anchor" aria-label="anchor" href="#micro-dsl-v34-source-format-grammar"></a></h2>
<p>This is the HUMAN-READABLE source format for v3.4. It extends v3.3 with semantic annotations and constrained types while maintaining clarity and completeness. A separate compilation step produces the compressed format.</p>
<p><strong>Budget</strong>: Target ≤ 250 lines or ≤ 2,500 tokens for optimal LLM processing.</p>
<p><strong>1. Document Structure:</strong></p>
<pre><code>@pkg package_name | description
[Type Aliases section]
[Constraint Definitions section]
[Legend section if needed]
# Package Name
[Sections with entries]
[Dependencies section]
[Meta-Footer]</code></pre>
<p><strong>2. Sigils (Same as v3.3):</strong></p>
<pre><code>@pkg - Package declaration
@f   - Function
@d   - Data object
@x   - Re-export from another package

S3 System:
@s3g - S3 generic (UseMethod)
@s3m - S3 method (generic.class)
@s3c - S3 class definition

S4 System:
@s4g - S4 generic (setGeneric)
@s4m - S4 method (setMethod)
@s4c - S4 class (setClass)

S7 System:
@s7g - S7 generic (new_generic)
@s7m - S7 method
@s7c - S7 class (new_class)

R6 System:
@r6c - R6 class (R6Class)</code></pre>
<p><strong>3. Type System (v3.4 Enhanced with Constraints):</strong></p>
<pre><code>Scalars (default): int, dbl, chr, lgl, raw, cpl
Vectors: vec&lt;type&gt; or type[]
Matrices: mat&lt;type&gt; or mat&lt;type,rows,cols&gt;
Arrays: arr&lt;type,dims&gt;
Lists: lst&lt;type&gt; or lst{field:type, ...} (structured)
Data frames: df, tbl, data.table
Factors: fct, ord
Dates: Date, POSIXct, POSIXlt

Union types: type1|type2|type3
Nullable: type? (shorthand for type|NULL)
Any type: any
Ellipsis: ... or ...:type (e.g., ...:expr for NSE)

Class types: s3:classname, s4:classname, r6:classname, s7:classname

CONSTRAINED TYPES (v3.4):
Enums: chr["opt1"|"opt2"|"opt3"]
Ranges: int[min..max], dbl[min..max]
Patterns: chr[/regex/]
Exclusions: int[1..100]&amp;!=[13,17]
References: @ref:constraint_name</code></pre>
<p><strong>4. Entry Format (v3.4 Enhanced):</strong></p>
<pre><code>@sigil name (param1:type1[constraint]?=default, param2:type2, ...) | Description -&gt; return_type | return_schema
  +tag:value +tag:value
  !cov [Class1, Class2] (for generics)
  - param1 : Additional description
    @annotation:value @annotation:value
  - param2 : (constants: "a", "b", CONST) Valid values
    @requires:condition @affects:target
  - param3 : (key_funcs: func1, func2) Related functions
    @lifecycle:init @units:measurement
  ```verbatim
  # Optional verbatim R code block</code></pre>
<pre><code>
**5. Type Aliases Section (v3.4 Enhanced):**
```markdown
## Type Aliases:
DF = df|tbl|data.table              # Standard data frame types
V&lt;T&gt; = vec&lt;T&gt;                       # Vector shorthand
Fml = s3:formula                    # Formula objects
Gg = s3:ggplot                      # ggplot2 objects
Config = lst{method:chr, opts:lst}  # Structured config
ValidPort = int[1024..65535]       # Constrained port range</code></pre>
<p><strong>Standard aliases</strong> (use these by default): - <code>DF</code> for data frame arguments - <code>Fml</code> for formula arguments (not <code>fml</code>) - <code>V&lt;T&gt;</code> for vectors when brevity helps</p>
<p><strong>6. Constraint Definitions (v3.4 New):</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">## Constraint Definitions:</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>@constraint positive_weights | Positive numeric weights</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  type: vec<span class="dt">&lt;</span><span class="kw">dbl</span><span class="dt">&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  validates: all(. &gt; 0)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  length: @env:nrow(data)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  </span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>@constraint valid_identifier | Valid R identifier</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  type: chr</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  pattern: /^<span class="co">[</span><span class="ot">a-zA-Z_</span><span class="co">][a-zA-Z0-9_.]</span>*$/</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  not_reserved: TRUE</span></code></pre></div>
<p><strong>7. Class Documentation (v3.4 Enhanced):</strong></p>
<pre><code>@s4c ClassName | One-line description
  - slots: name1 (type1[constraint]) @annotation:value
           name2 (type2) @lifecycle:init @immutable
  - extends: ParentClass
  - validity: Description of validity rules

@r6c ClassName | One-line description
  - fields: field1 (type1[constraint]) @purpose:role
            field2 (type2) @lazy @cached
  - methods: method1 (args) -&gt; ret_type
             method2 (args) -&gt; ret_type
  - inherits: ParentClass</code></pre>
<p><strong>8. Metadata Tags (v3.3 + v3.4 additions):</strong></p>
<pre><code>+family:group_name           # Function family
+pipe:in|out                # Pipe compatibility (in, out, or both)
+nse:param1,param2          # Parameters using NSE
+side:effect[details]       # Side effects with sub-facets
  - fs[read|write|delete]   # File system operations
  - plot[device|file]       # Graphics output
  - console[print|message|warning]  # Console output
  - network[http|socket|download]   # Network operations
  - options[get|set|env]    # Global options/environment
  - db[read|write|query]    # Database operations
+perf:O(complexity)         # Performance complexity
+mem:usage                  # Memory usage pattern
+compute:intensity          # Computational intensity
+deprecated:replacement     # Deprecation with suggested alternative
+wraps:function            # This function wraps another
+calls:func1,func2         # Functions called internally
+see:related1,related2     # Related functions to consider
+parallel:capable          # Can use parallel processing (v3.4)
+deterministic:false       # Non-deterministic results (v3.4)
+pure:false               # Has side effects (v3.4)</code></pre>
<p><strong>9. Semantic Annotations (v3.4 New):</strong></p>
<pre><code>BEHAVIORAL:
@controls:aspect          # Parameter controls specific behavior
@affects:target          # Changes affect another component
@modifies:target         # Directly modifies target

DEPENDENCY:
@requires:condition      # Prerequisite condition
@conflicts:parameter     # Mutually exclusive with
@extends:base           # Extends functionality

VALIDATION:
@validates:constraint    # Validation rule
@range:[min,max]        # Numeric range
@length:constraint      # Length requirement
@pattern:regex          # Pattern matching

SEMANTIC ROLE:
@purpose:role           # Semantic purpose
@units:measurement      # Physical/logical units
@example:value          # Example values
@default-reason:why     # Why this default

LIFECYCLE:
@lifecycle:stage        # When relevant (init|config|runtime|cleanup)
@immutable             # Cannot be modified
@cached                # Result is cached
@lazy                  # Evaluated on demand

CONDITIONAL:
@when:condition        # Conditional applicability
@implies:consequence   # Logical implication
@if:cond @then:result  # If-then constraints</code></pre>
<p><strong>10. Structured Return Types (v3.4 New):</strong></p>
<pre><code>-&gt; lst{
  field1: type1 @annotation,
  field2: type2[constraint] @annotation,
  nested: lst{
    subfield: type
  }
}</code></pre>
<p><strong>11. Example Entry (v3.4):</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>@f analyze_model (</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  model<span class="sc">:s3:</span>lm,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  type:chr<span class="co">[</span><span class="ot">"summary"|"anova"|"diagnostics"</span><span class="co">]</span>?="summary",</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  conf.level:dbl<span class="co">[</span><span class="ot">0.5..0.99</span><span class="co">]</span>?=0.95</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>) | Analyze fitted model -&gt; lst{</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  statistics: df @purpose:results,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  plots: lst<span class="dt">&lt;</span><span class="kw">s3:ggplot</span><span class="dt">&gt;</span>? @when:type="diagnostics",</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  interpretation: chr @purpose:summary</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>}</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  +family:analysis +compute:light</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="ss">  - </span>model : @requires:fitted @validates:has-residuals</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="ss">  - </span>type : @controls:output-format @affects:return-structure</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="ss">  - </span>conf.level : @purpose:confidence @affects:statistics.ci</span></code></pre></div>
<p><strong>12. Conditional Constraints (v3.4):</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>@f process_data (</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  data:df,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  method:chr<span class="co">[</span><span class="ot">"scale"|"center"|"none"</span><span class="co">]</span>?="none",</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  scale.center:lgl?=TRUE,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  scale.scale:lgl?=TRUE</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>) | Process data with scaling options -&gt; df</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="ss">  - </span>method : @controls:processing</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="ss">  - </span>scale.center : @when:method="scale" @requires:TRUE</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>                   @when:method="center" @implies:scale.scale=FALSE</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="ss">  - </span>scale.scale : @when:method="scale" @default:TRUE</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>                  @conflicts:method="center"</span></code></pre></div>
<p><strong>13. Best Practices (v3.4):</strong> - Use specific sigils (@s3g not @g) - Always specify vector vs scalar types - Use standard type aliases (DF, Fml, V<t>) - Add constraints from match.arg/stopifnot/checks - Keep !cov lists short (3-6 classes max) - Document semantic relationships concisely - Use structured types for complex returns - Define reusable constraints with @constraint - Include conditional logic with @when/@implies - Group related functions with +family tags - Mark side effects with detailed sub-facets - Stay within budget (≤250 lines)</t></p>
<p><strong>14. Meta-Footer:</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">## Meta-Footer</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">- Micro-DSL Version: v3.4-source</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">- Package: {pkg} (Version: X.Y.Z)</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">- Generated: [ISO-8601 timestamp]</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">- Features: types[constrained] sigils[specific] metadata[rich] semantics[annotated]</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">- Coverage: {n_documented_exports} / {n_total_exports} exports</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">- Provenance: exports[NAMESPACE], enums[match.arg/switch], constraints[assertions/checks]</span></span></code></pre></div>
<p><strong>15. Export Detection Priority:</strong> 1. NAMESPACE file: <code>export()</code>, <code>S3method()</code>, <code>exportClasses()</code>, <code>exportMethods()</code>, <code>exportPattern()</code> 2. Roxygen tags: <code>@export</code> in documentation 3. If neither present: skip the symbol (do not guess or include)</p>
<p><strong>16. Inference Heuristics (apply silently):</strong> - Type from defaults: TRUE/FALSE → lgl, “text” → chr, 1L → int, 1.0 → dbl - Common patterns: data/df/tbl → DF, formula → Fml, weights → vec<dbl> - Enums: match.arg(x, c(“a”,“b”)) → chr[“a”|“b”] - Ranges: stopifnot(x &gt;= 0 &amp;&amp; x &lt;= 1) → dbl[0..1] - Side effects: file.* → fs, plot/ggplot → plot, message/cat → console - Determinism: runif/sample/rnorm → +deterministic:false</dbl></p>
<hr><p>@pkg fmridesign | Design Matrix Construction for fMRI Analysis</p>
</div>
<div class="section level2">
<h2 id="type-aliases">Type Aliases:<a class="anchor" aria-label="anchor" href="#type-aliases"></a></h2>
<p>DF = df|tbl|data.table V<t> = vec<t> Fml = s3:formula Gg = s3:ggplot</t></t></p>
</div>
<div class="section level2">
<h2 id="constraint-definitions">Constraint Definitions:<a class="anchor" aria-label="anchor" href="#constraint-definitions"></a></h2>
<p>@constraint baseline_basis | Baseline basis type type: chr[“constant”|“poly”|“bs”|“ns”] validates: match.arg</p>
<p>@constraint intercept_type | Intercept type type: chr[“runwise”|“global”|“none”] validates: match.arg</p>
<p>@constraint positive_degree | Degree ≥ 1 type: int[1..] validates: degree &gt;= 1</p>
<p>@constraint blocklens_positive | Block lengths positive type: int[1..] validates: all(. &gt; 0)</p>
</div>
<div id="fmridesign" class="section level1">

<div class="section level2">
<h2 id="id_1-core-model-construction">1. Core Model Construction<a class="anchor" aria-label="anchor" href="#id_1-core-model-construction"></a></h2>
<p>@f baseline_model ( basis:chr[“constant”|“poly”|“bs”|“ns”]?=“constant”, degree:int[1..]?=1, sframe:any, intercept:chr[“runwise”|“global”|“none”]?=“runwise”, nuisance_list:lst&lt;mat<dbl>&gt;?=NULL ) | Build baseline model for drift/nuisance -&gt; s3:baseline_model +family:baseline +pipe:in|out - basis : @controls:drift-basis @validates:baseline_basis - degree : @controls:basis-complexity @validates:positive_degree - sframe : @purpose:sampling-frame - intercept : @controls:intercept-type @validates:intercept_type - nuisance_list : @purpose:nuisance-regressors</dbl></p>
<p>@f baseline ( degree:int[1..]?=1, basis:chr[“constant”|“poly”|“bs”|“ns”]?=“constant”, name:chr?=NULL, intercept:chr[“runwise”|“global”|“none”]?=“runwise” ) | Create baseline drift spec -&gt; s3:baselinespec +family:baseline</p>
<p>@f block (x:any) | Create block variable spec -&gt; s3:blockspec +family:baseline</p>
<p>@f nuisance (x:mat<dbl>) | Create nuisance term spec -&gt; s3:nuisancespec +family:baseline</dbl></p>
<p>@f construct (x:any, …) | Construct term from spec -&gt; any +family:construct !cov [baselinespec, blockspec, nuisancespec, covariatespec]</p>
<p>@f baseline_term (varname:chr, mat:mat<dbl>, colind:lst&lt;int[]&gt;, rowind:lst&lt;int[]&gt;) | Construct baseline term -&gt; s3:baseline_term +family:baseline</dbl></p>
</div>
<div class="section level2">
<h2 id="id_2-design-matrix-and-visualization">2. Design Matrix and Visualization<a class="anchor" aria-label="anchor" href="#id_2-design-matrix-and-visualization"></a></h2>
<p>@s3g design_matrix (x:any, …) | Extract design matrix -&gt; mat<dbl> +family:design +pipe:in|out !cov [baseline_model, baseline_term]</dbl></p>
<p>@s3g term_matrices (x:any, …) | Extract per-term matrices -&gt; lst&lt;mat<dbl>&gt; +family:design !cov [baseline_model]</dbl></p>
<p>@s3g cells (x:any, drop.empty:lgl?=TRUE, …) | Extract cell table -&gt; df +family:design !cov [baseline_model]</p>
<p>@s3g term_names (x:any, …) | Extract term names -&gt; chr[] +family:design !cov [baseline_model]</p>
<p>@s3g baseline_terms (x:any, …) | Extract baseline terms -&gt; lst<baseline_term> +family:design !cov [baseline_model]</baseline_term></p>
<p>@f design_map ( x:s3:baseline_model, block_separators:lgl?=TRUE, rotate_x_text:lgl?=TRUE, fill_midpoint:dbl?=NULL, fill_limits:vec<dbl>?=NULL, …:expr ) | Plot baseline design matrix heatmap -&gt; Gg +family:visual +side:plot[device]</dbl></p>
<p>@f correlation_map ( x:s3:baseline_model, method:chr[“pearson”|“spearman”]?=“pearson”, half_matrix:lgl?=FALSE, absolute_limits:lgl?=TRUE, …:expr ) | Plot baseline regressor correlation heatmap -&gt; Gg +family:visual +side:plot[device]</p>
<p>@f plot ( x:s3:baseline_model, term_name:chr?=NULL, title:chr?=NULL, xlab:chr?=“Time”, ylab:chr?=“Design Matrix Value”, line_size:dbl?=1, color_palette:chr?=“Set1”, …:expr ) | Plot baseline model terms -&gt; Gg +family:visual +side:plot[device] +pipe:in</p>
<p>@s3g print (x:any, …) | Print summary to console -&gt; invisible<any> +family:console +side:console[print] !cov [baseline_model, contrast_set, contrast_spec, contrast, poly_contrast_spec, contrast_diff_spec]</any></p>
</div>
<div class="section level2">
<h2 id="id_3-parametric-basis-constructors">3. Parametric Basis Constructors<a class="anchor" aria-label="anchor" href="#id_3-parametric-basis-constructors"></a></h2>
<p>@f Ident (…:any) | Identity basis for variables -&gt; s3:Ident +family:basis</p>
<p>@f Poly (x:vec<dbl>, degree:int[1..]) | Orthogonal polynomial basis -&gt; s3:Poly +family:basis</dbl></p>
<p>@f BSpline (x:vec<dbl>, degree:int[1..]) | B-spline basis -&gt; s3:BSpline +family:basis</dbl></p>
<p>@f Standardized (x:vec<dbl>) | Standardize vector (z-score) -&gt; s3:Standardized +family:basis</dbl></p>
<p>@f Scale (x:vec<dbl>) | Z-score basis (global) -&gt; s3:Scale +family:basis</dbl></p>
<p>@f ScaleWithin (x:vec<dbl>, g:fct) | Z-score within groups -&gt; s3:ScaleWithin +family:basis</dbl></p>
<p>@f RobustScale (x:vec<dbl>) | Robust scale (median/MAD) -&gt; s3:RobustScale +family:basis</dbl></p>
<p>@s3g predict (object:any, newdata:vec<dbl>, …) | Predict basis values -&gt; mat<dbl> +family:basis !cov [BSpline, Poly, Ident, Standardized, Scale, ScaleWithin, RobustScale, ParametricBasis]</dbl></dbl></p>
<p>@s3g sub_basis (x:any, subset:int[]|lgl[]) | Subset basis object -&gt; s3:ParametricBasis +family:basis !cov [BSpline, Poly, Ident, Standardized, Scale, ScaleWithin, RobustScale]</p>
<p>@s3g levels (x:any, …) | Basis or factor levels -&gt; chr[] +family:basis !cov [BSpline, Poly, Ident, Standardized, Scale, ScaleWithin, RobustScale]</p>
<p>@s3g columns (x:any, …) | Basis column names -&gt; chr[] +family:basis !cov [BSpline, Poly, Ident, Standardized, Scale, ScaleWithin, RobustScale]</p>
<p>@s3g nbasis (x:any, …) | Number of basis functions -&gt; int +family:basis !cov [BSpline, Poly, Ident, Standardized, Scale, ScaleWithin, RobustScale, covariate_convolved_term, hrfspec]</p>
</div>
<div class="section level2">
<h2 id="id_4-contrast-specification-and-weights">4. Contrast Specification and Weights<a class="anchor" aria-label="anchor" href="#id_4-contrast-specification-and-weights"></a></h2>
<p>@f contrast ( form:Fml, name:chr, where:Fml?=NULL ) | Formula-based contrast spec -&gt; s3:contrast_formula_spec +family:contrast</p>
<p>@f unit_contrast ( A:Fml, name:chr, where:Fml?=NULL ) | Unit contrast (sum=1) -&gt; s3:unit_contrast_spec +family:contrast</p>
<p>@f pair_contrast ( A:Fml, B:Fml, name:chr, where:Fml?=NULL, basis:int[]|chr[“all”]?=NULL, basis_weights:vec<dbl>?=NULL ) | Pairwise sum-to-zero contrast -&gt; s3:pair_contrast_spec +family:contrast</dbl></p>
<p>@f oneway_contrast ( A:Fml, name:chr, where:Fml?=NULL, basis:int[]|chr[“all”]?=NULL, basis_weights:vec<dbl>?=NULL ) | One-way (main effect) contrast -&gt; s3:oneway_contrast_spec +family:contrast</dbl></p>
<p>@f interaction_contrast ( A:Fml, name:chr, where:Fml?=NULL ) | Interaction contrast spec -&gt; s3:interaction_contrast_spec +family:contrast</p>
<p>@f poly_contrast ( A:Fml, name:chr, where:Fml?=NULL, degree:int[1..]?=1, value_map:lst?=NULL, basis:int[]|chr[“all”]?=NULL, basis_weights:vec<dbl>?=NULL ) | Polynomial trend contrast -&gt; s3:poly_contrast_spec +family:contrast</dbl></p>
<p>@f column_contrast ( pattern_A:chr, pattern_B:chr?=NULL, name:chr, where:Fml?=NULL ) | Contrast by column regex -&gt; s3:column_contrast_spec +family:contrast</p>
<p>@f contrast_set (…:s3:contrast_spec) | Set of contrasts -&gt; s3:contrast_set +family:contrast</p>
<p>@f pairwise_contrasts ( levels:chr[], facname:chr, where:Fml?=NULL, name_prefix:chr?=“con” ) | All pairwise contrasts -&gt; s3:contrast_set +family:contrast</p>
<p>@f one_against_all_contrast ( levels:chr[], facname:chr, where:Fml?=NULL ) | Each level vs others -&gt; s3:contrast_set +family:contrast</p>
<p>@f sliding_window_contrasts ( levels:chr[], facname:chr, window_size:int[1..]?=2, where:Fml?=NULL, name_prefix:chr?=“win” ) | Disjoint window contrasts -&gt; s3:contrast_set +family:contrast</p>
<p>@s3g contrast_weights (x:any, term:any, …) | Compute contrast weights -&gt; lst|mat<dbl> +family:contrast !cov [unit_contrast_spec, oneway_contrast_spec, interaction_contrast_spec, poly_contrast_spec, pair_contrast_spec, column_contrast_spec, contrast_formula_spec, contrast_diff_spec, contrast_set]</dbl></p>
<p>@s3g Fcontrasts (x:any, …) | Compute F-contrasts -&gt; lst&lt;mat<dbl>&gt; +family:contrast !cov [convolved_term, event_model, event_term]</dbl></p>
<p>@s3g print (x:s3:contrast_set|s3:contrast_spec|s3:contrast|s3:poly_contrast_spec|s3:contrast_diff_spec, …) | Print contrast info -&gt; invisible<any> +family:contrast +side:console[print]</any></p>
<p>@f plot_contrasts (x:any, …) | Plot contrast weights heatmap -&gt; Gg +family:contrast +side:plot[device] !cov [event_model]</p>
<p>@f -.contrast_spec (e1:s3:contrast_spec, e2:s3:contrast_spec, …) | Difference of contrasts -&gt; s3:contrast_diff_spec +family:contrast</p>
</div>
<div class="section level2">
<h2 id="id_5-covariate-and-event-model-utilities">5. Covariate and Event Model Utilities<a class="anchor" aria-label="anchor" href="#id_5-covariate-and-event-model-utilities"></a></h2>
<p>@f covariate ( …:expr, <a href="data:DF" class="uri">data:DF</a>, id:chr?=NULL, prefix:chr?=NULL, subset:expr?=NULL ) | Covariate term (non-convolved) -&gt; s3:covariatespec +family:covariate</p>
<p>@s3g construct (x:s3:covariatespec, model_spec:any, sampling_frame:any?=NULL, …) | Construct covariate term -&gt; s3:covariate_convolved_term +family:covariate</p>
<p>@s3g event_table (x:s3:covariate_convolved_term, …) | Covariate event table -&gt; df +family:covariate</p>
<p>@s3g nbasis (x:s3:covariate_convolved_term, …) | Number of covariate columns -&gt; int +family:covariate</p>
</div>
<div class="section level2">
<h2 id="id_6-design-metadata-and-diagnostics">6. Design Metadata and Diagnostics<a class="anchor" aria-label="anchor" href="#id_6-design-metadata-and-diagnostics"></a></h2>
<p>@s3g design_colmap (x:any, …) | Column metadata tibble -&gt; df +family:design !cov [event_model, baseline_model]</p>
<p>@s3g term_indices (x:any, …) | Map terms to column indices -&gt; lst&lt;int[]&gt; +family:design !cov [default]</p>
</div>
<div class="section level2">
<h2 id="id_7-s3-generics-for-eventbaseline-models">7. S3 Generics for Event/Baseline Models<a class="anchor" aria-label="anchor" href="#id_7-s3-generics-for-eventbaseline-models"></a></h2>
<p>@s3g event_model (formula_or_list:Fml|lst, <a href="data:DF" class="uri">data:DF</a>, block:Fml, sampling_frame:any, drop_empty:lgl?=TRUE, durations:vec<dbl>?=0, …) | Create event model -&gt; s3:event_model +family:model</dbl></p>
<p>@s3g event_terms (x:any, …) | Extract event terms -&gt; lst<any> +family:model</any></p>
<p>@s3g conditions (x:any, drop.empty:lgl?=TRUE, expand_basis:lgl?=FALSE, …) | Condition names -&gt; chr[] +family:model</p>
<p>@s3g convolve (x:any, hrf:any, sampling_frame:any, drop.empty:lgl?=TRUE, summate:lgl?=TRUE, precision:dbl?=0.1, …) | Convolve events with HRF -&gt; mat<dbl> +family:model</dbl></p>
<p>@s3g elements (x:any, what:chr[“values”|“labels”]?=“values”, transformed:lgl?=TRUE, …) | Extract event elements -&gt; any +family:model</p>
<p>@s3g event_conditions (x:any, drop.empty:lgl?=FALSE, …) | Per-event condition assignments -&gt; fct +family:model</p>
<p>@s3g events (x:any, drop.empty:lgl?=FALSE, …) | Event info table -&gt; df +family:model</p>
<p>@s3g is_categorical (x:any, …) | Is object categorical? -&gt; lgl +family:model</p>
<p>@s3g is_continuous (x:any, …) | Is object continuous? -&gt; lgl +family:model</p>
<p>@s3g longnames (x:any, …) | Fully qualified event names -&gt; chr[] +family:model</p>
<p>@s3g shortnames (x:any, …) | Short event names -&gt; chr[] +family:model</p>
<p>@s3g regressors (x:any, …) | Extract regressor names -&gt; chr[] +family:model</p>
<p>@s3g split_by_block (x:any, …) | Split object by block/run -&gt; lst<any> +family:model</any></p>
<p>@s3g split_onsets (x:any, sframe:any, global:lgl?=FALSE, blocksplit:lgl?=FALSE, …) | Split onsets by block/condition -&gt; lst&lt;vec<dbl>&gt; +family:model</dbl></p>
<p>@s3g residualize (x:any, <a href="data:mat" class="uri">data:mat</a><dbl>|df, cols:int[]|chr[]?=NULL, …) | Residualize data against design -&gt; mat<dbl> +family:model</dbl></dbl></p>
</div>
<div class="section level2">
<h2 id="id_8-miscellaneous">8. Miscellaneous<a class="anchor" aria-label="anchor" href="#id_8-miscellaneous"></a></h2>
<p>@f check_collinearity (x:mat<dbl>|df, tol:dbl?=1e-8) | Check for collinearity in matrix -&gt; lgl +family:diagnostic</dbl></p>
<p>@f basis_suffix (nbasis:int[1..], pad:int[1..]?=2) | Generate basis suffixes -&gt; chr[] +family:utility</p>
<p>@f condition_basis_list ( x:s3:event_term, hrf:any, sampling_frame:any, …:expr, output:chr[“condition_list”|“matrix”]?=“condition_list” ) | Split event term by condition basis -&gt; lst&lt;mat<dbl>&gt;|mat<dbl> +family:utility</dbl></dbl></p>
</div>
<div class="section level2">
<h2 id="id_9-re-exports">9. Re-exports<a class="anchor" aria-label="anchor" href="#id_9-re-exports"></a></h2>
<p>@x blockids | Block IDs from fmrihrf -&gt; int[] +wraps:fmrihrf::blockids +see:fmrihrf::blockids</p>
<p>@x blocklens | Block lengths from fmrihrf -&gt; int[] +wraps:fmrihrf::blocklens +see:fmrihrf::blocklens</p>
<p>@x HRF | HRF object from fmrihrf -&gt; s3:HRF +wraps:fmrihrf::HRF +see:fmrihrf::HRF</p>
<p>@x as_hrf | Coerce to HRF from fmrihrf -&gt; s3:HRF +wraps:fmrihrf::as_hrf +see:fmrihrf::as_hrf</p>
<p>@x durations | Event durations from fmrihrf -&gt; vec<dbl> +wraps:fmrihrf::durations +see:fmrihrf::durations</dbl></p>
<p>@x onsets | Event onsets from fmrihrf -&gt; vec<dbl> +wraps:fmrihrf::onsets +see:fmrihrf::onsets</dbl></p>
<p>@x gen_hrf | Generate HRF from fmrihrf -&gt; s3:HRF +wraps:fmrihrf::gen_hrf +see:fmrihrf::gen_hrf</p>
<p>@x hrf_spmg1 | SPMG1 HRF from fmrihrf -&gt; s3:HRF +wraps:fmrihrf::hrf_spmg1 +see:fmrihrf::hrf_spmg1</p>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a></h2>
<ul><li>Imports: fmrihrf (&gt;= 0.1.0), stats, assertthat, rlang, stringr, dplyr, tidyr, purrr, tibble, Matrix, splines, plotly, ggplot2, utils, cli</li>
<li>Suggests: testthat, knitr, rmarkdown, covr</li>
</ul><hr></div>
<div class="section level2">
<h2 id="meta-footer">Meta-Footer<a class="anchor" aria-label="anchor" href="#meta-footer"></a></h2>
<ul><li>Micro-DSL Version: v3.4-source</li>
<li>Package: fmridesign (Version: 0.1.0)</li>
<li>Generated: 2024-06-29T00:00:00Z</li>
<li>Features: types[constrained] sigils[specific] metadata[rich] semantics[annotated]</li>
<li>Coverage: 70 / 70 exports</li>
<li>Provenance: exports[NAMESPACE], enums[match.arg/switch], constraints[assertions/checks]</li>
</ul></div>
</div>


  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

